
add-rclocal

tạo folder file.

rc.local.origin

#!/bin/bash

exit 0

tạo folder templates

rc-local-ubuntu.j2

#!/bin/bash
#
# rc.local
#
# This script is executed at the end of each multiuser runlevel.
# Make sure that the script will "exit 0" on success or any other
# value on error.
#
# In order to enable or disable this script just change the execution
# bits.
#
# By default this script does nothing.

/sbin/ip route add 172.19.254.0/24 via 172.19.7.254 dev vlan2102

/sbin/ip route add 10.3.22.200 via 172.19.7.254 dev vlan2102

exit 0



tạo đường dẫn đăng ký câu lệnh rc_local_check.

- name: Check file rc.local
  stat:
    path: /etc/rc.local
  register: rc_local_check


sao chép nội dung vào file ra.local

- name: Create rc.local if not exist
 copy:
    src: rc.local.origin
    dest: /etc/rc.local
    owner: root
    group: root
    mode: 0755
  when: rc_local_check.stat.exists == False


thêm nội dung của file  rc-local-ubuntu.j2 vào file  rc.local

- name: Add command to /etc/rc.local
  template:
    src: rc-local-ubuntu.j2
    dest: /etc/rc.local
    owner: root
    group: root
    mode: 0755

cho phép file file hoạt động ngay lập tức.

- name: Execute the command to add route immediaterly
  shell: bash /etc/rc.local



